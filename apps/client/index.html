<!doctype html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<link rel="icon" type="image/svg+xml" href="/vite.svg" />

	<!-- Mobile viewport and optimization meta tags -->
	<meta name="viewport"
		content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
	<meta name="format-detection" content="telephone=no" />
	<meta name="msapplication-tap-highlight" content="no" />

	<link rel="icon"
		href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%2210 0 100 100%22><text y=%22.90em%22 font-size=%2290%22>‚ö°</text></svg>" />
	<title>Zappy Place</title>
</head>

<body>
	<div id="app">
		<div id="canvas-container"></div>

		<div id="ui-overlay">
			<div id="coordinates-panel">
				<span id="coordinates">992,226</span>
			</div>

			<div id="help-button" title="Help & Tutorial">?</div>

			<div id="nostr-status-panel">
				<div id="connection-status">üåê Connecting...</div>
				<div id="user-info" class="hidden"></div>
			</div>

			<div id="zoom-controls">
				<button class="zoom-btn" id="zoom-in">+</button>
				<button class="zoom-btn" id="zoom-out">‚àí</button>
				<button class="action-btn" id="undo-btn" title="Undo">‚Ü∂</button>
			</div>

			<div id="preview-panel" class="preview-panel hidden">
				<div class="preview-header">
					<h3>üé® Preview Mode</h3>
					<div class="preview-header-controls">
						<button id="preview-minimize" class="preview-btn minimize-btn" title="Minimize panel">‚àí</button>
						<button id="preview-cancel" class="preview-btn cancel-btn">Cancel</button>
					</div>
				</div>
				<div class="preview-options">
					<label class="toggle-container">
						<input type="checkbox" id="cost-mode-toggle">
						<span class="toggle-slider"></span>
						<span class="toggle-label">üí∞ Cost Mode</span>
					</label>
				</div>
				<div class="cost-breakdown">
					<div id="cost-summary">No pixels placed</div>
					<div id="cost-details" class="cost-details"></div>
				</div>
				<div class="preview-actions">
					<button id="preview-submit" class="preview-btn submit-btn" disabled>
						Submit & Zap
					</button>
				</div>
			</div>
		</div>

		<div id="color-palette-container">
			<div id="color-palette-scroll-container">
				<div id="color-palette"></div>
			</div>
		</div>
	</div>

	<div id="tutorial-modal" class="hidden">
		<div class="tutorial-content">
			<div class="tutorial-header">
				<h2>üé® Welcome to Zappy Place!</h2>
				<button class="tutorial-close" id="tutorial-close">√ó</button>
			</div>

			<div class="tutorial-section">
				<h3>‚ö° What is Zappy Place?</h3>
				<p>
					Zappy Place is a fully decentralized, censorship-resistant pixel canvas inspired by Reddit Place.
					It's powered by the <strong>Nostr protocol</strong> and <strong>Lightning Network</strong> for
					instant, uncensorable pixel placement.
				</p>
				<p>
					Unlike traditional pixel canvases that rely on centralized servers, Zappy Place lives entirely on
					the Nostr network.
					Your pixels are stored forever across distributed relays, making the canvas truly permanent and
					unstoppable.
				</p>
			</div>

			<div class="tutorial-section">
				<h3>üéØ How to Play</h3>
				<ul>
					<li><strong>Choose a Color:</strong> Select from the color palette on the left</li>
					<li><strong>Navigate:</strong> Use mouse/touch to pan around the canvas, zoom with scroll wheel or
						buttons</li>
					<li><strong>Place Pixels:</strong> Click anywhere on the canvas to place pixels and enter preview
						mode. On mobile, tap and hold to place pixels.</li>
					<li><strong>Preview Mode:</strong> Place multiple pixels, see cost breakdown, and position your
						design</li>
					<li><strong>Submit & Zap:</strong> Pay with Lightning to make your pixels permanent</li>
					<li><strong>Collaborate:</strong> Work with others to create amazing pixel art!</li>
				</ul>
			</div>

			<div class="tutorial-section">
				<h3>üí∞ Smart Pricing System</h3>
				<p>
					Zappy Place uses age-based pricing to encourage collaboration while protecting recent artwork.
					The older a pixel is, the cheaper it becomes to overwrite:
				</p>

				<div class="pricing-grid">
					<div class="pricing-item">
						<strong>New Pixels</strong><br>
						Empty spaces: <strong>1 sat</strong>
					</div>
					<div class="pricing-item expensive">
						<strong>Fresh Pixels</strong><br>
						&lt; 1 hour old: <strong>10 sats</strong>
					</div>
					<div class="pricing-item moderate">
						<strong>Recent Pixels</strong><br>
						1-24 hours old: <strong>5 sats</strong>
					</div>
					<div class="pricing-item cheap">
						<strong>Older Pixels</strong><br>
						1-7 days old: <strong>2 sats</strong>
					</div>
					<div class="pricing-item cheapest">
						<strong>Ancient Pixels</strong><br>
						&gt; 1 week old: <strong>1 sat</strong>
					</div>
				</div>

				<p>
					<strong>üí° Pro Tip:</strong> Enable "Cost Mode" in preview to see age-based color borders around
					existing pixels!
				</p>
			</div>

			<div class="tutorial-section">
				<h3>üöÄ Preview Mode Features</h3>
				<ul>
					<li><strong>Batch Placement:</strong> Place up to 300 pixels before submitting</li>
					<li><strong>Cost Breakdown:</strong> See exactly how much your design will cost</li>
					<li><strong>Smart Relocation:</strong> Drag your entire design to find cheaper spots</li>
					<li><strong>Visual Feedback:</strong> Your pixels glow, existing pixels dim</li>
					<li><strong>Undo Support:</strong> Use the undo button to remove preview pixels</li>
				</ul>
			</div>

			<div class="tutorial-section">
				<h3>üîë Getting Started</h3>
				<p>
					To place pixels permanently, you'll need a <strong>Nostr identity</strong> and some
					<strong>Lightning Network</strong> sats.
					If you're new to Nostr, <a href="https://nostr.how/en/get-started" target="_blank">you can follow
						this guide to get started!</a>
				</p>
			</div>

			<div class="tutorial-footer">
				<label>
					<input type="checkbox" id="dont-show-again">
					Don't show this again
				</label>
				<button id="tutorial-start">Start Creating!</button>
			</div>
		</div>
	</div>

	<div class="footer">
		<!-- GitHub Button -->
		<a class="github-button" href="https://github.com/andrewmunro/zappy-place"
			data-color-scheme="no-preference: light; light: light; dark: dark;" data-size="large"
			aria-label="Follow @andrewmunro on GitHub">GitHub</a><br />
		Made with ‚òï by <a href="https://nostr.band/npub12pdvt4vtsa86gwed7a4v96rdshr26m8y7em5d0q4tryqal6875dqttsgfz"
			target="_blank" style="text-decoration: none;">Andrew</a>
	</div>

	<script src="https://unpkg.com/nostr-login@latest/dist/unpkg.js" data-title="Login with Nostr"
		data-description="Choose a login method with Nostr to place pixels on the collaborative canvas."
		data-signup-relays="wss://relay.damus.io,wss://relay.nostr.band,wss://nos.lol,wss://relay.primal.net"
		data-outbox-relays="wss://sendit.nosflare.com,wss://relay.damus.io,wss://relay.nostr.band,wss://nos.lol,wss://relay.primal.net"></script>

	<script type="module" src="/src/main.ts"></script>

	<!-- Place this tag in your head or just before your close body tag. -->
	<script async defer src="https://buttons.github.io/buttons.js"></script>
</body>

</html>